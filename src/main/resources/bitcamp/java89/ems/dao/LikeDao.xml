<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="bitcamp.java89.ems.dao.LikeDao">
  <resultMap type="like" id="like-map">
    <id     column="itno"  property="itemNo"/>
    <id     column="mno"   property="memberNo"/>
    <result column="type"  property="type"/>
    <result column="rdt" property="readTime"/>
    
    <result column="titl"  property="title"/>
    <result column="time"  property="startTime"/>
    <result column="stpc"  property="startPrice"/>
    
    <collection property="photoList" ofType="photo">
      <id     column="pno"  property="photoNo"/>
      <result column="path" property="filePath"/>
    </collection>
  </resultMap>
  
  <select id="getLikeList" resultMap="like-map">
    <![CDATA[
    select
      m.mno,
      i.itno,
      i.titl,
      i.time,
      i.stpc,
      p.path,
      t.type,
      t.rdt
    from memb m
    left outer join item i on m.mno=i.itno
    left outer join inter t on m.mno=t.mno
    left outer join phot p on i.itno=p.itno
    where rdt < now() and t.type=1 and m.mno=#{memberNo}
    order by rdt desc;
    ]]>
  </select>
  
<!--   <insert id="insert" parameterType="like"
  useGeneratedKeys="true" keyColumn="itno" keyProperty="itemNo">
    insert into like(mno,titl,stpc,path,type,time)
    select
      #{memberNo},
      #{title},
      #{startPrice},
      #{path},
      #{type},
      #{rdt}
    from like
    order by rdt desc
  </insert>  -->
  
   <!-- <delete id="delete" parameterType="int">
    delete from like where likeNo=#{value}
  </delete> -->

</mapper>