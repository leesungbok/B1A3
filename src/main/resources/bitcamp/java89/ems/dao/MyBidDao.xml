<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="bitcamp.java89.ems.dao.MyBidDao">
  <resultMap type="mybid" id="mybid-map">
    <id     column="mno"   property="memberNo"/>
    <id     column="itno"  property="itemNo"/>
    <result column="titl"  property="title"/>
    <result column="bids"  property="bids"/>
    <result column="time"  property="time"/>
    
    <collection property="photoList" ofType="photo">
      <id     column="pno"  property="photoNo"/>
      <result column="path" property="filePath"/>
    </collection>

  </resultMap>
  
  <select id="getMyBidList" parameterType="int" resultMap="mybid-map">
    <![CDATA[
    select
      i.itno,
      i.titl,
      i.bids,
      i.time,
      (select count(*) from BDHS where ITNO = 1) as i.cnt,
      p.path
    from item i
    left outer join phot p on i.itno=p.itno
    where time > now()
    order by time asc
    limit #{startRowIndex}, #{rowSize}
    ]]>
  </select>
  
<!--   <insert id="insert" parameterType="like"
  useGeneratedKeys="true" keyColumn="itno" keyProperty="itemNo">
    insert into like(mno,titl,stpc,path,type,time)
    select
      #{memberNo},
      #{title},
      #{startPrice},
      #{path},
      #{type},
      #{rdt}
    from like
    order by rdt desc
  </insert>  -->
  
   <!-- <delete id="delete" parameterType="int">
    delete from like where likeNo=#{value}
  </delete> -->

</mapper>